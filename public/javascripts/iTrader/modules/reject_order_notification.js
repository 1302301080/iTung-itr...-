define(function(require,exports,module){function a(){OrderMgr.on(function(a){if(f&&(new Date).getTime-f>1e3&&(e=!0),f=(new Date).getTime(),a)for(var b=0;b<a.length;b++){var c=a[b];c&&c._raw&&c._raw[5]==-1&&(h[c._raw[6]]?h[c._raw[6]][25]=c._raw[25]:h[c._raw[6]]={6:c._raw[6],25:c._raw[25],modifiedDatetime:c.modifiedDatetime,unread:!!e,DT_RowId:"order-reject-"+c._raw[6]})}}),$(document).click(function(){b()}),setInterval(function(){b()},1e4),setTimeout(function(){e=!0},5e3)}function b(){if(h)for(var a in h)if(h[a].unread)return void c()}function c(){g||(g=!0,showMessage({title:messages.dialog_reject_order_reason_title.text,message:d(),buttonNameList:["close"],callback:function(a,b){"close"===a.name&&b.close()},onshown:function(){var a=[];for(var b in h)a.push(h[b]);a=a.sort(function(a,b){return a.unread&&!b.unread?-1:b.unread&&!a.unread?1:a.modifiedDatetime>b.modifiedDatetime?-1:1});var c=$("#reject-order-table");c.CreateDatatable({columnSchema:[{key:"modifiedDatetime",i18n:"column_datetime"},{key:"6",i18n:"column_order_no"},{key:"25",i18n:"column_remark"}],order:[],data:a,searching:!1}),c.translate(),c.find("tr").each(function(){var a=$(this).attr("id");for(var b in h)if("order-reject-"+h[b][6]===a&&h[b].unread){$(this).addClass("text-danger");break}})},onhidden:function(){g=!1;for(var a in h)h[a].unread=!1}}))}function d(){var a=$("<div></div>"),b=$("<table>",{id:"reject-order-table","class":"table table-bordered table-hover table-condensed table-striped"}),c=$("<thead></thead>"),d=$("<tbody>");return a.append(b.append(c).append(d)),a.translate(),a.html()}var e=!1,f=null,g=!1,h={};exports.init=a});