define(function(require,exports,module){function a(a,k){if(a&&!(a.length<=0)){k=k||{},k.columnSchema&&e(a,k);var l={language:k.language||messages.datatables,paging:"undefined"==typeof k.paging||k.paging,lengthChange:"undefined"!=typeof k.lengthChange&&k.lengthChange,searching:"undefined"==typeof k.searching||k.searching,ordering:"undefined"==typeof k.ordering||k.ordering,info:"undefined"==typeof k.info||k.info,autoWidth:"undefined"!=typeof k.autoWidth&&k.autoWidth,columns:k.columns||(k.columnSchema?d(k):null),order:k.order,rowId:k.rowId||"DT_RowId",columnDefs:k.columnDefs,aoColumnDefs:k.aoColumnDefs,pageLength:k.pageLength,data:k.data,buttons:k.buttons,serverSide:k.serverSide,processing:k.processing,ajax:k.ajax,pagingType:k.pagingType||"simple_numbers",pagingInput:k.pagingInput||!0,columnSchema:k.columnSchema,columnHeaderPrefix:k.columnHeaderPrefix,openRowColumnIndex:k.openRowColumnIndex};k.dom&&(l.dom=k.dom),k.scrollY&&(l.scrollY=k.scrollY,scrollCollapse=!!k.scrollCollapse&&k.scrollCollapse),k.scrollX&&(l.scrollX=k.scrollX,scrollCollapse=!!k.scrollCollapse&&k.scrollCollapse),j&&(l.searching=!1,l.info=!1,l.buttons=null,l.pagingType="simple_numbers",l.pagingInput=!1);var m=a.DataTable(l).on("draw.dt",function(){a.find("[extra-row-open=true]").each(function(){$(this).find("i").removeClass("fa-minus-circle").addClass("fa-plus-circle"),$(this).attr("extra-row-open",!1)}),a.format()});return l.searching&&i($(m.table().container())),m.UpdateRowData=function(a,d){if(k.columnSchema){c(a,k);var e,i=m.row("#"+a.DT_RowId);return d&&d.IsRemove&&d.IsRemove(a)?void(i&&"function"==typeof i.remove&&i.remove()):(i&&i.length>0?(e=i.row(i[0]),e.isNewRow=!1,e.data(a)):(e=m.row.add(a),e.isNewRow=!0),b(m,e,k),h(e,k),f(e,k),j||(g(e,k),$(e.node()).find("td").on("mouseenter",function(){this.offsetWidth<this.scrollWidth?$(this).attr("title",$(this).text()):$(this).removeAttr("title")})),e)}},m.HandleDataColumns=b,m}}function b(a,b,c){if(c=c||{},c.columnSchema)for(var d=-1,e=0;e<c.columnSchema.length;e++){var f=c.columnSchema[e];if(!(f.tooltip||j&&f.mobile===!1)){d++;var g=$(a.cell(b.selector.rows,d).node());g&&(f.format&&g.attr("data-format",f.format),f["class"]&&g.addClass(f["class"]))}}}function c(a,b){if(b=b||{},b.columnSchema)for(var c=0;c<b.columnSchema.length;c++){var d=b.columnSchema[c],e=d.key.toString();"undefined"==typeof a[e]&&("undefined"!=typeof d["default"]?a[e]=d["default"]:a[e]=null)}}function d(a){if(!a||!a.columnSchema)return[];for(var b=[],c=0;c<a.columnSchema.length;c++)if(!(a.columnSchema[c].tooltip||j&&a.columnSchema[c].mobile===!1)){var d=a.columnSchema[c].key.toString();b.push({data:d})}return b}function e(a,b){a.find("thead").length<=0&&a.append("<thead></thead>");var c=$("<tr></tr>");if(b=b||{},b.columnSchema)for(var d=0;d<b.columnSchema.length;d++){var e=b.columnSchema[d];if(!(j&&e.mobile===!1||e.tooltip)){var f=e.i18n||b.columnHeaderPrefix+e.key,g=$("<th>").append($("<span>",{"data-i18n":f,"class":e.headClass||"",title:e.headTitle}));c.append(g)}}a.find("thead").append(c)}function f(a,b){a&&a.node()&&a.isNewRow&&j&&$(a.node()).click(function(c){if(!$(c.target).parents("td").hasClass("prevent-popup-detail")&&!$(c.target).parents("table").hasClass("prevent-popup-detail")){for(var d=$("<ul>",{"class":"list-group"}),e=0;e<b.columnSchema.length;e++){var f=b.columnSchema[e],g=f.key,h=a.data(),i=$.extend(!0,{},h);if(!i[g]||0!==i[g].toString().indexOf("<")){var j=f.i18n||b.columnHeaderPrefix+f.key;messages[j]&&d.append($("<li>",{"class":"list-group-item"}).append($("<b>",{text:messages[j].text,"class":"content-overflow-hidden-30"})).append($("<span>",{"class":"text-primary pull-right content-overflow-hidden-60",text:i[g],"data-format":f.format})))}}if(!(d.find("li").length<=0)){var k=$("<div>").append(d);showMessage({title:messages.dialog_detail_title.text,message:k,onshow:function(a){k.translate(),k.format()},buttonNameList:["close"],callback:function(a,b){"close"===a.name&&b.close()}})}}})}function g(a,b){a&&a.node()&&$(a.node()).find(".extra-tooltip").each(function(){"tooltip"!==$(this).attr("data-toggle")&&($(this).attr("data-toggle","tooltip").attr("data-placement","right"),$(this).tooltip({html:!0,container:"body",title:function(){for(var c=a.data(),d=$("<table>"),e=0;e<b.columnSchema.length;e++){var f=b.columnSchema[e];if(f.tooltip){var g=$("<tr>"),h=b.i18nPrefix?messages[b.i18nPrefix]:messages,i=h[f.i18n]?h[f.i18n].text:"",j=c[f.key]||("undefined"!=typeof f["default"]?f["default"]:"");g.append("<td style='text-align:left; padding-right:20px; word-break: keep-all;white-space:nowrap;'>{0}</td>".format(i)),g.append("<td style='text-align:left; word-break: keep-all;white-space:nowrap;' data-format='{0}'>{1}</td>".format(f.format,j)),d.append(g)}}return d.format(),d.html()}}))})}function h(a,b){a&&a.node()&&"function"==typeof b.getExtraRow&&($(a.node()).find(".extra-row").each(function(){var c=b.getExtraRow(a);if(c){$(this).addClass("pointer"),$(this).attr("extra-row-open",!1);var d=$(this).find("i");d.length<=0&&$(this).prepend("<i class='fa fa-plus-circle text-info'></i>")}}),a.isNewRow&&$(a.node()).find(".extra-row").click(function(){var c=b.getExtraRow(a);if(c){var d="true"===$(this).attr("extra-row-open");if(d)$(a.node()).next().remove(),$(this).find("i").removeClass("fa-minus-circle").addClass("fa-plus-circle");else{$(this).find("i").removeClass("fa-plus-circle").addClass("fa-minus-circle");var e=$(a.node()),f=e.find("td").length,g=$("<tr>").append($("<td>",{colspan:f}).append(c));$(a.node()).after(g)}$(this).attr("extra-row-open",!d)}}))}function i(a){!a||a.length<=0||a.find(".dataTables_filter label input").attr("placeHolder",messages.datatables.sSearchPlaceHolder)}var j=require("mobile").GetIsMobile();$.fn.CreateDatatable=function(b){return a($(this),b)}});