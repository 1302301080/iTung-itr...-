define(function(require,exports,module){function a(a,b){var d="";a&&a.sessionID&&(d="sessionID="+a.sessionID);var e,f;c.showMessage({title:messages.change_password_title.text,closeByBackdrop:!1,closeByKeyboard:!1,load:{url:"/iTrader/security/password/change/?"+d+"&tempNo="+(new Date).getTime(),callback:function(){e=$("#change-password-panel"),f=$("#change-password-form"),d&&f.find("[name=sessionID]").val(a.sessionID),e.translate(),validateForm(f,{errorPlacement:function(a,b){a.appendTo(b.parent("div"))},showErrors:function(a,b){if(b&&b.length)for(var c=0;c<b.length;c++){var d=b[c];d&&d.message&&d.message.error&&(d.message.error[39]&&String(d.message.error[39]).indexOf("SSMITSERR_")<0&&(d.message.error[39]="SSMITSERR_"+d.message.error[39]),d.message=getErrorMessage(d.message.error))}this.defaultShowErrors()},submitHandler:function(a){$.ajax({type:"post",url:"/iTrader/security/password/change",data:f.serialize(),success:function(a){a&&a.error?(a&&a.error&&a.error[tags.errorCode]&&(a.error[tags.errorCode]="SSMITSERR_"+a.error[tags.errorCode]),handleError(a.error)):(a.password=$("[name=new_password]").val(),c.alertMessage({title:messages.dialog_information_title.text,message:messages.change_password_success_message.text,onclose:function(c){c.close(),b&&b(a)}}))},error:handleError})}})}},buttonNameList:["submit","reset"],callback:function(a,b){"submit"===a.name?f.valid()&&(f.submit(),b.close()):"reset"===a.name&&(document.getElementById("change-password-form").reset(),f.find("label.has-error").remove(),f.find(".has-success, .has-error").each(function(){$(this).removeClass("has-success").removeClass("has-error")}))}})}function b(a,b){if(a&&b){var d=a.url;if(d){var e="EN",f=$("html").attr("lang");"zh-CN"==f?e="ZH-CN":"zh-HK"===f&&(e="ZH-HK"),d+=(d.indexOf("?")<0?"?":"&")+"CULTURE="+e,c.showMessage({closeByBackdrop:!1,closeByKeyboard:!1,title:messages.login_forget_password_title.text,message:"<iframe src='{0}' frameborder='0' height='450px' width='100%'></iframe>".format(d)})}}}var c=require("dialog");exports.change=a,exports.reset=b});