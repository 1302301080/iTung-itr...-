define(function(require,exports,module){function a(a){$(document).on("ticket-added",function(a,b){if(b&&6==b[tags.productType]){var c=b[tags.currency]||"";if($("#ticket-bond-min-purchase-amount").text($._format.pattern(b[3401],g)+"({0})".format(c)),$("#ticket-bond-incremental-amount").text($._format.pattern(b[3402],g)+"({0})".format(c)),$("#ticket-bond-coupon-rate").text($._format.percentage(b[3403],2)),$("#ticket-bond-settlement-date").text(moment(b[540],"YYYYMMDD").format("YYYY/MM/DD")),$("#ticket-bond-pre-coupon-date").text(moment(b[3404],"YYYYMMDD").format("YYYY/MM/DD")),$("#ticket-bond-transaction-fee").text($._format.percentage(b[3407],2)),e.length>0){e.focus();var d=e.attr("placeHolder"),h=d.indexOf("(%)"),i=b[1504];i&&"1"!=i?h<0&&e.attr("placeHolder",d+"(%)"):h>=0&&e.attr("placeHolder",d.replace("(%)","")),$("#ticket-bond-display-ratio").val(i),e.focus()}f.InputFormat()}})}function b(){$(".bond-info").text(""),e.val(""),f.val("")}function c(a,b){if(a){b=b||{};var c={},d=b.side||0,e=a[tags.currency],f=a[23]||"",h=a[3605],i=a[3407]||"",j=a[3408]||"",k=a[3407]||"",l=a[3408]||"";a[3606]&&(k=a[3606]),a[3607]&&(l=a[3607]);var m=a[540]||"",n=a[3404]||"",o=a[3609]||"",p="";a[3403]&&(p=$._format.pattern(100*a[3403],"#,##0.########")+"%");var q="";a[3]&&(q=$._format.pattern(a[3]*(a[1504]||1),"#,##0.00######"));var r="({0})".format(e);return c.price={name:messages.column_price.text+": ",value:q+r},c.currency={name:messages.orderbook_header_23.text+": ",value:f},c.cRate={name:messages.ticket_bond_coupon_rate.text,value:p||""},c.cPFrequency={name:messages.ticket_bond_coupon_payment_frequency.text,value:o||""},c.txn={name:messages.ticket_bond_transaction_fee.text,value:$._format.percentage(i,2)},c.minTxnAmount={name:messages.ticket_bond_min_transaction_fee_amount.text,value:$._format.amount(j)+r},c.txnSell={name:messages.ticket_bond_transaction_feeSell.text,value:$._format.percentage(k,2)},c.minTxnAmountSell={name:messages.ticket_bond_min_transaction_fee_amountSell.text,value:$._format.amount(l)+r},c.minAmt={name:messages.ticket_bond_min_purchase_amount.text,value:$._format.pattern(a[3401],g)+r},c.incrementalAmt={name:messages.ticket_bond_incremental_amount.text,value:$._format.pattern(a[3402],g)+r},c.sDate={name:messages.ticket_bond_settlement_date.text,value:m||""},c.preCouDate={name:messages.ticket_bond_pre_coupon_date.text,value:n||""},16&h?(c.txn.value=messages.FreeTransactionFee.text,c.minTxnAmount=messages.FreeTransactionFee.text):32&h&&(0!=d||2&h?1!=d||4&h||(delete c.txn,delete c.minTxnAmt):(delete c.txn,delete c.minTxnAmt)),1==d&&(c.availableQuantity={name:messages.ticket_bond_available_quantity.text,value:$._format.pattern(GetMaxSellSync(a[0]),g)}),c}}function d(a){$.get("/iTrader/bond/disclaimer",function(b){b&&b.url?showMessage({title:messages.dialog_disclosure_title.text,buttonNameList:["agree","reject"],load:{url:getMultiLanguageURL(b)},callback:function(b,c){var d=b.attr("id");"btn-reject"===d?(a(!1),a=null):"btn-agree"===d&&(a(!0),a=null),c.close()},onshow:function(a){a.getModalBody().css("max-height","450px")},onhide:function(){a&&a(!1)}}):a(!0)})}var e=$("#ticket-bond-price"),f=$("#ticket-PAR-value"),g=initial_data.format.bond_unit;exports.init=a,exports.clear=b,exports.getBondInfo=c,exports.popupBondDisclaimer=d});