define(function(require,exports,module){function a(a,h){if(a&&!(a.length<=0)){h=h||{},h.columnSchema&&e(a,h);var i={language:h.language||messages.datatables,scrollX:"undefined"!=typeof h.scrollX&&h.scrollX,paging:"undefined"==typeof h.paging||h.paging,lengthChange:"undefined"!=typeof h.lengthChange&&h.lengthChange,searching:"undefined"==typeof h.searching||h.searching,ordering:"undefined"==typeof h.ordering||h.ordering,info:"undefined"==typeof h.info||h.info,autoWidth:"undefined"!=typeof h.autoWidth&&h.autoWidth,columns:h.columns||(h.columnSchema?d(h):null),order:h.order,rowId:h.rowId||"DT_RowId",columnDefs:h.columnDefs,aoColumnDefs:h.aoColumnDefs,pageLength:h.pageLength,data:h.data,buttons:h.buttons,serverSide:h.serverSide,processing:h.processing,ajax:h.ajax,pagingType:h.pagingType||"simple_numbers",pagingInput:h.pagingInput||!0,columnSchema:h.columnSchema,columnHeaderPrefix:h.columnHeaderPrefix};h.dom&&(i.dom=h.dom);var j=a.DataTable(i).on("draw.dt",function(){a.format()});return j.UpdateRowData=function(a,d){if(h.columnSchema){c(a,h);var e,f=j.row("#"+a.DT_RowId);return d&&d.IsRemove&&d.IsRemove(a)?void(f&&"function"==typeof f.remove&&f.remove()):(f&&f.length>0?(e=f.row(f[0]),e.isNewRow=!1,e.data(a)):(e=j.row.add(a),e.isNewRow=!0),b(j,e,h),g(e,h),e)}},j.UpdateDataTableSearchBox=f,j}}function b(a,b,c){if(c=c||{},c.columnSchema)for(var d=-1,e=0;e<c.columnSchema.length;e++){var f=c.columnSchema[e];if(!f.tooltip){d++;var g=$(a.cell(b.selector.rows,d).node());g&&(f.format&&g.attr("data-format",f.format),f["class"]&&g.addClass(f["class"]))}}}function c(a,b){if(b=b||{},b.columnSchema)for(var c=0;c<b.columnSchema.length;c++){var d=b.columnSchema[c],e=d.key.toString();"undefined"==typeof a[e]&&("undefined"!=typeof d["default"]?a[e]=d["default"]:a[e]=null)}}function d(a){if(!a||!a.columnSchema)return[];for(var b=[],c=0;c<a.columnSchema.length;c++)if(!a.columnSchema[c].tooltip){var d=a.columnSchema[c].key.toString();b.push({data:d})}return b}function e(a,b){a.find("thead").length<=0&&a.append("<thead></thead>");var c=$("<tr></tr>");if(b=b||{},b.columnSchema)for(var d=0;d<b.columnSchema.length;d++)if(!b.columnSchema[d].tooltip){var e=b.columnSchema[d].i18n||b.columnHeaderPrefix+b.columnSchema[d].key;c.append("<td data-i18n='"+e+"'></td>")}a.find("thead").append(c)}function f(a){!a||a.length<=0||a.find(".dataTables_filter label input").attr("placeHolder",messages.datatables.sSearchPlaceHolder)}function g(a,b){a&&a.node()&&$(a.node()).find(".extra-tooltip").each(function(){"tooltip"!==$(this).attr("data-toggle")&&($(this).attr("data-toggle","tooltip").attr("data-placement","right"),$(this).tooltip({html:!0,container:"body",title:function(){for(var c=a.data(),d=$("<table>"),e=0;e<b.columnSchema.length;e++){var f=b.columnSchema[e];if(f.tooltip){var g=$("<tr>"),h=messages[f.i18n]?messages[f.i18n].text:"",i=c[f.key]||("undefined"!=typeof f["default"]?f["default"]:"");g.append("<td style='text-align:left; padding-right:20px; word-break: keep-all;white-space:nowrap;'>{0}</td>".format(h)),g.append("<td style='text-align:left; word-break: keep-all;white-space:nowrap;' data-format='{0}'>{1}</td>".format(f.format,i)),d.append(g)}}return d.format(),d.html()}}))})}$.fn.CreateDatatable=function(b){return a($(this),b)},exports.CreateDatatable=a});