define(function(require,exports,module){function a(){var a=j.find("span[data-key]").attr("data-key"),c=i.find("span[data-key]").attr("data-key");$.get("/iTrader/estatement/files?&period="+a+"&selectType="+c,function(a){d(a),b()})}function b(){k.find(".btn-icon-spinner").addClass("hidden"),k.find(".btn-icon-search").removeClass("hidden"),k.removeAttr("disabled")}function c(b){e=b,!e||e.length<=0||$.get("/iTrader/initialize",function(b){g=b;for(var c={name:{i18n:"eStatement_type"},data:[{key:"0",value:messages.eStatement_type_daily.text},{key:"1",value:messages.eStatement_type_monthly.text}]},d={name:{i18n:"eStatement_period"},data:[]},e=0;e<g.views.eStatement.periods.daily.length;e++){var l=g.views.eStatement.periods.daily[e];d.data.push({key:l,value:messages["eStatement_period_daily_"+l].text})}for(var m={name:{i18n:"eStatement_period"},data:[]},n=0;n<g.views.eStatement.periods.monthly.length;n++){var l=g.views.eStatement.periods.monthly[n];m.data.push({key:l,value:messages["eStatement_period_monthly_"+l].text})}f=h.CreateDatatable({searching:!1,columnSchema:[{name:"acct",key:"account","class":"text-left",i18n:"column_account"},{name:"period",key:"date","class":"text-left",i18n:"eStatement_date"},{name:"subject",key:"filename","class":"text-left",i18n:"eStatement_subject"}],order:[1,"desc"]}),i.CreateDrowdownGroup(c),j.CreateDrowdownGroup(d),i.on("change",function(a,b){var c=i.find("span[data-key]").attr("data-key");0==c?j.CreateDrowdownGroup(d):j.CreateDrowdownGroup(m)}),k.click(function(){k.find(".btn-icon-spinner").removeClass("hidden"),k.find(".btn-icon-search").addClass("hidden"),k.attr("disabled","disabled"),a()}),$(document).translate()})}function d(a){if(f.clear(),a){for(var b=0;b<a.length;b++)a[b].filename="<a href='{0}' target='_blank'>{1}</a><span class='text-muted'><i class='fa fa-file-pdf-o icon-left-margin'></i></span>".format(a[b].link,a[b].filename),f.UpdateRowData(a[b]);f.draw()}}require("datatables");var e,f,g,h=$("#estatement-table"),i=$("#estatement-type"),j=$("#estatement-period"),k=$("#eStatement_btn");exports.init=c});